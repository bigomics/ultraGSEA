[{"path":"https://bigomics.github.io/ultragsea/articles/compare-methods.html","id":"fast-pre-ranked-enrichment-methods","dir":"Articles","previous_headings":"","what":"Fast pre-ranked enrichment methods","title":"Comparing with other methods","text":"comparisons, selected currently fastest pre-ranked gene set enrichment algorithms: fGSEA (fast GSEA). fGSEA currently perhaps widely used algorithm pre-ranked enrichment testing. See: github bioRxiv cameraPR (pre-ranked Camera limma package). version Camera method pre-ranked lists. See: paper GOAT (Gene set Ordinal Association Test). fast method using precomputed null distributions. See: paper github. particular interested compare algorithms terms runtime, score p-value.","code":""},{"path":"https://bigomics.github.io/ultragsea/articles/compare-methods.html","id":"preparing-the-sparse-gene-set-matrix","dir":"Articles","previous_headings":"","what":"Preparing the sparse gene set matrix","title":"Comparing with other methods","text":"benchmark use example dataset fgsea package includes examples gene sets examplePathways (1457 sets) example ranked list exampleRanks (12000 genes). filter gene sets less 10 genes, partly GOAT handle . filtering, retain 761 gene sets.","code":"library(fgsea) library(goat) #> Loading required package: dplyr #>  #> Attaching package: 'dplyr' #> The following objects are masked from 'package:stats': #>  #>     filter, lag #> The following objects are masked from 'package:base': #>  #>     intersect, setdiff, setequal, union library(ultragsea) #>  #> Attaching package: 'ultragsea' #> The following object is masked from 'package:fgsea': #>  #>     fgsea data(examplePathways) data(exampleRanks) fc = exampleRanks gmt = examplePathways range(sapply(gmt,length)) #> [1]    1 2366 gmt <- lapply(gmt, function(s) intersect(s,names(fc))) gmt <- gmt[sapply(gmt,length)>=10] G <- gmt2mat(gmt) length(fc) #> [1] 12000 length(gmt) #> [1] 761"},{"path":"https://bigomics.github.io/ultragsea/articles/compare-methods.html","id":"running-the-methods","dir":"Articles","previous_headings":"","what":"Running the methods","title":"Comparing with other methods","text":"Run code want increase number gene sets testing. benchmarking, use peakRAM measure runtime memory usage method.","code":"if(0) {   ## run this to increase the number of gene sets.   gmt <- rep(gmt,40)   length(gmt)   names(gmt) <- make.unique(names(gmt))   G <- do.call(cbind, rep(list(G),40))   colnames(G) <- make.unique(colnames(G))   dim(G) } library(peakRAM) gs <- names(gmt) tt <- peakRAM::peakRAM(   res.fgsea <- fgsea::fgsea(gmt, fc, eps=0),   res.cameraPR <- limma::cameraPR(fc, gmt, use.ranks=FALSE)[gs,],   res.ultragsea.z <- ultragsea(G, fc, method='ztest')[gs,],   res.ultragsea.c <- ultragsea(G, fc, method='cor')[gs,],   res.cortest <- gset.cor(G, fc, compute.p=TRUE, use.rank=FALSE),   res.ztest <- gset.ztest(G, fc),   res.goat <- goat(gmt, fc, filter=FALSE) ) tt[,1] <- gsub(\"res[.]|<-.*\",\"\",tt[,1]) kableExtra::kable(tt) rt <- tt[,2] names(rt) <- tt[,1] par(mar=c(5,8,2,2)) barplot(sort(rt,decreasing=TRUE), horiz=TRUE, las=1, log=\"x\",   xlab=\"runtime (sec)\")"},{"path":"https://bigomics.github.io/ultragsea/articles/compare-methods.html","id":"comparing-the-scores","dir":"Articles","previous_headings":"","what":"Comparing the scores","title":"Comparing with other methods","text":"can compare scores methods. see scores correlated . CameraPR return score value, score computed -log(p)*sign score. plotting need make sure results tables aligned.  Notice gap particular S-curve fgsea shows. Also cameraPR shows curve compared others. can compare better comparing ranks scores:","code":"res.fgsea <- res.fgsea[match(gs,res.fgsea$pathway),] res.goat <- res.goat[match(gs,res.goat$pathway),] res.cameraPR$score <- -log(res.cameraPR$PValue)*(-1+2*(res.cameraPR$Direction==\"Up\"))  Z <- cbind(   fgsea = res.fgsea$NES,   cameraPR = res.cameraPR$score,   ultragsea.z = res.ultragsea.z$score,   ultragsea.c = res.ultragsea.c$score,   goat = res.goat$score ) pairs(Z, pch='.',cex=4) pairs(apply(Z,2,rank), pch='.',cex=4)"},{"path":"https://bigomics.github.io/ultragsea/articles/compare-methods.html","id":"comparing-the-p-values","dir":"Articles","previous_headings":"","what":"Comparing the p-values","title":"Comparing with other methods","text":"Next, can compare p-values methods. Also , see p-values highly correlated .","code":"P <- cbind(   fgsea = res.fgsea$pval,   cameraPR = res.cameraPR$PValue,   ultragsea.z = res.ultragsea.z$pval,   ultragsea.c = res.ultragsea.c$pval,   goat = res.goat$pval ) mlp <- -log10(P) pairs(mlp, pch='.',cex=4)"},{"path":"https://bigomics.github.io/ultragsea/articles/compare-methods.html","id":"replacing-fgsea","dir":"Articles","previous_headings":"Comparing the p-values","what":"Replacing fgsea","title":"Comparing with other methods","text":"Much slowness fgsea can attributed permutations calculating p-values. previous section, seen p-values ultragsea (cor z-test) follow quite well fgsea. Therefore, make fgsea::fgsea() faster, can instead calculate p-values using ultragsea. created replacement function ultragsea::fgsea() 8-10x faster original fgsea::fgsea()","code":"system.time(res1 <- fgsea::fgsea(gmt, fc)) #>    user  system elapsed  #>   3.015   0.058   3.614 system.time(res2 <- ultragsea::fgsea(gmt, fc)) #>    user  system elapsed  #>   0.230   0.109   0.272"},{"path":"https://bigomics.github.io/ultragsea/articles/ultragsea.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Getting Started with ultragsea","text":"ultragsea novel, ultrafast memory optimized gene set enrichment scoring algorithm unlike fGSEA. ultragsea demonstrates highly correlated gene set scores p-values typically 100 times faster fGSEA.","code":""},{"path":[]},{"path":"https://bigomics.github.io/ultragsea/articles/ultragsea.html","id":"preparing-gensets","dir":"Articles","previous_headings":"Example","what":"Preparing gensets","title":"Getting Started with ultragsea","text":"vignette, retrieve Hallmark gene sets using msigdbr package. course can use gene sets download somewhere else.","code":"library(ultragsea) library(msigdbr) gs <- msigdbr::msigdbr(collection = \"H\") gmt <- tapply(gs$gene_symbol,gs$gs_name,list) length(gmt) #> [1] 50"},{"path":"https://bigomics.github.io/ultragsea/articles/ultragsea.html","id":"performing-the-statistical-test","dir":"Articles","previous_headings":"Example","what":"Performing the statistical test","title":"Getting Started with ultragsea","text":"Just example use random values fc general fold change statistical comparison experiment. fastest speed, especially computing enrichment multiple foldchanges, better call low-level functions geneset correlation geneset z-test directly. return nicely formatted output tables ultragsea() much faster optimized matrix inputs F.","code":"G <- gmt2mat(gmt) fc <- rnorm(nrow(G)) names(fc) <- rownames(G) res <- ultragsea(G, fc, format='as.gsea', method='cor') res <- ultragsea(G, fc, format='as.gsea', method='ztest') head(res) #>                               pathway      pval      padj log2err          ES #>                                <char>     <num>     <num>   <num>       <num> #> 1:           HALLMARK_APICAL_JUNCTION 0.8342058 0.9704642      NA  0.08430629 #> 2:           HALLMARK_HEME_METABOLISM 0.8734178 0.9704642      NA  0.06417051 #> 3:     HALLMARK_INFLAMMATORY_RESPONSE 0.7112720 0.9704642      NA  0.14908865 #> 4:         HALLMARK_KRAS_SIGNALING_UP 0.9759219 0.9759219      NA -0.01215674 #> 5: HALLMARK_OXIDATIVE_PHOSPHORYLATION 0.8635639 0.9704642      NA -0.06921354 #> 6:              HALLMARK_ADIPOGENESIS 0.2245049 0.7015779      NA  0.48923213 #>            NES  size                             leadingEdge #>          <num> <int>                                  <list> #> 1:  0.19554431   200 CRAT,HRAS,INSIG1,PIK3R3,ACTN2,ADAM9,... #> 2:  0.14884035   200    CA2,BNIP3L,CDC27,H1-0,BCAM,BLVRA,... #> 3:  0.34580382   200    IL4R,CCL2,HBEGF,INHBA,ITGB3,EREG,... #> 4: -0.02819697   200        BMP2,CCND2,LIF,CFB,CSF2,PLAT,... #> 5: -0.16053742   200 ACAA1,SDHC,ECHS1,GPI,GRPEL1,ATP6V1F,... #> 6:  1.13474996   200  ALDOA,ECH1,GPX4,CRAT,DHCR7,GADD45A,... F <- cbind(fc,fc,fc,fc,fc) res1 <- gset.cor(G, F, compute.p=TRUE) res2 <- gset.ztest(G, F)"},{"path":"https://bigomics.github.io/ultragsea/articles/ultragsea.html","id":"plotting","dir":"Articles","previous_headings":"Example","what":"Plotting","title":"Getting Started with ultragsea","text":"can proceed plotting gene set using e.g. plotting functions fgsea package.","code":"#library(fgsea) #k <- res$pathway[which.min(res$pval)] #fgsea::plotEnrichment(gmt[[k]],fc,ticksSize = 0.2)"},{"path":"https://bigomics.github.io/ultragsea/articles/ultragsea.html","id":"session-info","dir":"Articles","previous_headings":"","what":"Session info","title":"Getting Started with ultragsea","text":"","code":"sessionInfo() #> R version 4.5.2 (2025-10-31) #> Platform: x86_64-pc-linux-gnu #> Running under: Ubuntu 24.04.3 LTS #>  #> Matrix products: default #> BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3  #> LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.26.so;  LAPACK version 3.12.0 #>  #> locale: #>  [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8        #>  [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8    #>  [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C           #> [10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C    #>  #> time zone: UTC #> tzcode source: system (glibc) #>  #> attached base packages: #> [1] stats     graphics  grDevices utils     datasets  methods   base      #>  #> other attached packages: #> [1] msigdbr_25.1.1   ultragsea_0.1.12 BiocStyle_2.38.0 #>  #> loaded via a namespace (and not attached): #>  [1] Matrix_1.7-4        babelgene_22.9      jsonlite_2.0.0      #>  [4] dplyr_1.1.4         compiler_4.5.2      BiocManager_1.30.27 #>  [7] tidyselect_1.2.1    slam_0.1-55         parallel_4.5.2      #> [10] assertthat_0.2.1    jquerylib_0.1.4     systemfonts_1.3.1   #> [13] textshaping_1.0.4   yaml_2.3.12         fastmap_1.2.0       #> [16] lattice_0.22-7      R6_2.6.1            generics_0.1.4      #> [19] qlcMatrix_0.9.9     curl_7.0.0          knitr_1.50          #> [22] tibble_3.3.0        bookdown_0.46       desc_1.4.3          #> [25] bslib_0.9.0         pillar_1.11.1       rlang_1.1.6         #> [28] cachem_1.1.0        xfun_0.54           fs_1.6.6            #> [31] sass_0.4.10         cli_3.6.5           pkgdown_2.2.0       #> [34] withr_3.0.2         magrittr_2.0.4      digest_0.6.39       #> [37] grid_4.5.2          docopt_0.7.2        lifecycle_1.0.4     #> [40] vctrs_0.6.5         sparsesvd_0.2-3     data.table_1.17.8   #> [43] evaluate_1.0.5      glue_1.8.0          ragg_1.5.0          #> [46] rmarkdown_2.30      matrixStats_1.5.0   tools_4.5.2         #> [49] pkgconfig_2.0.3     htmltools_0.5.9"},{"path":"https://bigomics.github.io/ultragsea/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Ivo Kwee. Author. Antonino Zito. Maintainer.","code":""},{"path":"https://bigomics.github.io/ultragsea/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Kwee (2025). ultragsea: Ultrafast preranked gene set enrichment analysis. R package version 0.1.12, https://github.com/bigomics/ultragsea.","code":"@Manual{,   title = {ultragsea: Ultrafast preranked gene set enrichment analysis},   author = {Ivo Kwee},   year = {2025},   note = {R package version 0.1.12},   url = {https://github.com/bigomics/ultragsea}, }"},{"path":"https://bigomics.github.io/ultragsea/index.html","id":"ultragsea-ultrafast-preranked-gene-set-enrichment-analysis-wip-","dir":"","previous_headings":"","what":"Ultrafast preranked gene set enrichment analysis","title":"Ultrafast preranked gene set enrichment analysis","text":"(Warning: work progress! use production purposes) ultragsea ultrafast method compute gene set enrichment preranked list genes unlike fGSEA. ultragsea can used replacement fGSEA. Although ultragsea uses different statistical test (namely z-test correlation), scores highly correlated p-values closely similar GSEA’s weighted Kolmogorov-Smirnov test. ultragsea computes scores using fast sparse computation parametric p-values typically 100-1000x faster fGSEA.","code":""},{"path":"https://bigomics.github.io/ultragsea/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Ultrafast preranked gene set enrichment analysis","text":"can install ultragsea GitHub:","code":"remotes::install_github(\"bigomics/ultragsea\")"},{"path":"https://bigomics.github.io/ultragsea/index.html","id":"usage","dir":"","previous_headings":"","what":"Usage","title":"Ultrafast preranked gene set enrichment analysis","text":"detailed usage examples tutorials, please see vignettes: Getting Started ultragsea Comparing ultragsea methods ultragsea main gene set scoring algorithm OmicsPlayground, Bioinformatics platform BigOmics Analytics. OmicsPlayground, can perform ultragsea without coding needs.","code":""},{"path":"https://bigomics.github.io/ultragsea/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Ultrafast preranked gene set enrichment analysis","text":"{r} library(ultragsea) gs <- msigdbr::msigdbr(collection = \"H\") gmt <- tapply(gs$gene_symbol,gs$gs_name,list) G <- gmt2mat(gmt) fc <- rnorm(nrow(G)) names(fc) <- rownames(G) res <- ultragsea(fc, G, format='.gsea', method='ztest') head(res)","code":""},{"path":"https://bigomics.github.io/ultragsea/index.html","id":"references","dir":"","previous_headings":"","what":"References","title":"Ultrafast preranked gene set enrichment analysis","text":"technical details please refer papers. Please cite us use ultragsea part research. ultragsea: Ultrafast preranked gene set enrichment scoring. Akhmedov M., et al., Omics Playground: comprehensive self-service platform visualization, analytics exploration Big Omics Data, NAR Genomics Bioinformatics, 2020, lqz019.","code":""},{"path":"https://bigomics.github.io/ultragsea/index.html","id":"support","dir":"","previous_headings":"","what":"Support","title":"Ultrafast preranked gene set enrichment analysis","text":"support feel free reach Bioinformatics Data Science Team BigOmics Analytics: help@bigomics.ch like ultragsea, please recommend us friends, buy us coffee brag ultragsea social media.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/cor_sparse_matrix.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate sparse correlation matrix handling missing values — cor_sparse_matrix","title":"Calculate sparse correlation matrix handling missing values — cor_sparse_matrix","text":"Calculate sparse correlation matrix handling missing values","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/cor_sparse_matrix.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate sparse correlation matrix handling missing values — cor_sparse_matrix","text":"","code":"cor_sparse_matrix(G, mat)"},{"path":"https://bigomics.github.io/ultragsea/reference/cor_sparse_matrix.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate sparse correlation matrix handling missing values — cor_sparse_matrix","text":"G Sparse matrix containing gene sets mat Matrix values","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/cor_sparse_matrix.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate sparse correlation matrix handling missing values — cor_sparse_matrix","text":"Correlation matrix G mat","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/cor_sparse_matrix.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate sparse correlation matrix handling missing values — cor_sparse_matrix","text":"mat missing values, calculates correlation directly using corSparse. Otherwise computes column-wise correlations using non-missing values.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/fgsea.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast replacement of fgsea with p/q values computed with ultragsea.cor — fgsea","title":"Fast replacement of fgsea with p/q values computed with ultragsea.cor — fgsea","text":"Fast replacement fgsea p/q values computed ultragsea.cor","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/fgsea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast replacement of fgsea with p/q values computed with ultragsea.cor — fgsea","text":"","code":"fgsea(pathways, stats, minSize = 1, maxSize = length(stats) - 1, nperm = 20)"},{"path":"https://bigomics.github.io/ultragsea/reference/gmt2mat.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert GMT to Binary Matrix — gmt2mat","title":"Convert GMT to Binary Matrix — gmt2mat","text":"Convert GMT file (Gene Matrix Transposed) binary matrix, rows represent genes columns represent gene sets. binary matrix indicates presence absence genes gene set.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/gmt2mat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert GMT to Binary Matrix — gmt2mat","text":"","code":"gmt2mat(   gmt,   max.genes = -1,   ntop = -1,   sparse = TRUE,   bg = NULL,   use.multicore = TRUE )"},{"path":"https://bigomics.github.io/ultragsea/reference/gmt2mat.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert GMT to Binary Matrix — gmt2mat","text":"gmt List representing GMT file: element character vector representing gene set. max.genes Max number genes include binary matrix. Default = -1 include genes. ntop Number top genes consider gene set. Default = -1 include genes. sparse Logical: create sparse matrix. Default TRUE. FALSE creates dense matrix. bg Character vector background gene set. Default NULL consider unique genes. use.multicore Logical: use parallel processing ('parallel' R package). Default TRUE.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/gmt2mat.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert GMT to Binary Matrix — gmt2mat","text":"binary matrix representing presence absence genes gene set. Rows correspond genes, columns correspond gene sets.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/gmt2mat.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert GMT to Binary Matrix — gmt2mat","text":"","code":"# Create example GMT data gmt <- list(   \"Pathway1\" = c(\"GENE1\", \"GENE2\", \"GENE3\"),   \"Pathway2\" = c(\"GENE2\", \"GENE4\", \"GENE5\"),   \"Pathway3\" = c(\"GENE1\", \"GENE5\", \"GENE6\") )  # Convert to binary matrix mat <- gmt2mat(gmt) print(mat) #> 6 x 3 sparse Matrix of class \"dgCMatrix\" #>       Pathway1 Pathway2 Pathway3 #> GENE1        1        .        1 #> GENE2        1        1        . #> GENE5        .        1        1 #> GENE3        1        .        . #> GENE4        .        1        . #> GENE6        .        .        1  # Create dense matrix instead of sparse mat_dense <- gmt2mat(gmt, sparse = FALSE) print(mat_dense) #>       Pathway1 Pathway2 Pathway3 #> GENE1        1        0        1 #> GENE2        1        1        0 #> GENE5        0        1        1 #> GENE3        1        0        0 #> GENE4        0        1        0 #> GENE6        0        0        1"},{"path":"https://bigomics.github.io/ultragsea/reference/goat.html","id":null,"dir":"Reference","previous_headings":"","what":"Wrapper around GOAT — goat","title":"Wrapper around GOAT — goat","text":"Wrapper around GOAT","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/goat.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Wrapper around GOAT — goat","text":"","code":"goat(   pathways,   stats,   minSize = 10L,   maxSize = 1500L,   filter = TRUE,   method = c(\"goat\", \"gsea\")[1] )"},{"path":"https://bigomics.github.io/ultragsea/reference/gset.cor.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate gene set correlation — gset.cor","title":"Calculate gene set correlation — gset.cor","text":"Compute correlation foldchange vector/matrix gene sets","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/gset.cor.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate gene set correlation — gset.cor","text":"","code":"gset.cor(FC, gset, compute.p = FALSE, use.rank = FALSE, corshrink = 0)"},{"path":"https://bigomics.github.io/ultragsea/reference/gset.cor.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate gene set correlation — gset.cor","text":"FC Numeric vector matrix (log)foldchanges, genes row names gset Numeric matrix gene sets, genes row/column names compute.p Logical indicating whether compute p-values use.rank Logical indicating whether rank transform FC correlation","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/gset.cor.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate gene set correlation — gset.cor","text":"Named list components: rho - Matrix correlation coefficients FC gset p.value - Matrix p-values correlation (compute.p = TRUE) q.value - Matrix FDR adjusted p-values (compute.p = TRUE)","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/gset.cor.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate gene set correlation — gset.cor","text":"function calculates sparse rank correlation FC column gset using qlcMatrix::corSparse(). handles missing values FC computing column-wise correlations. P-values computed statistical distribution","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/gset.cor.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate gene set correlation — gset.cor","text":"","code":"if (FALSE) { # \\dontrun{ library(playbase) ranks <- sample(1:10000, 1000, replace = TRUE) names(ranks) <- replicate(1000, paste(sample(LETTERS, 4, replace = TRUE), collapse = \"\")) genesets <- matrix(rnorm(1000 * 20), ncol = 20) rownames(genesets) <- names(ranks)  gset.rankcor(ranks, genesets, compute.p = TRUE) } # }"},{"path":"https://bigomics.github.io/ultragsea/reference/gset.ztest.html","id":null,"dir":"Reference","previous_headings":"","what":"Fast one sample z-test for matrix object F (e.g. foldchanges) and grouping matrix G (e.g. gene sets). — gset.ztest","title":"Fast one sample z-test for matrix object F (e.g. foldchanges) and grouping matrix G (e.g. gene sets). — gset.ztest","text":"Fast one sample z-test matrix object F (e.g. foldchanges) grouping matrix G (e.g. gene sets).","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/gset.ztest.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fast one sample z-test for matrix object F (e.g. foldchanges) and grouping matrix G (e.g. gene sets). — gset.ztest","text":"","code":"gset.ztest(F, G, alpha = 0.5, center = TRUE, pdist = \"norm\")"},{"path":"https://bigomics.github.io/ultragsea/reference/gset.ztest.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fast one sample z-test for matrix object F (e.g. foldchanges) and grouping matrix G (e.g. gene sets). — gset.ztest","text":"G Numeric matrix gene sets, genes row names alpha Numeric value 0 1 Bayesian shrinkage center Logical value center population mean assume zero fc Numeric vector (log)foldchanges, genes names","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/gset.ztest.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fast one sample z-test for matrix object F (e.g. foldchanges) and grouping matrix G (e.g. gene sets). — gset.ztest","text":"List components: z_statistic - Vector z-test statistics p_value - Vector p-values","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/makeGseaResult.html","id":null,"dir":"Reference","previous_headings":"","what":"Utility to convert fgsea/ultragsea style results to 'gseaResult' object compatible with clusterProfiler and enrichplot functions. Using this function you can use all plotting functions from enrichplot. — makeGseaResult","title":"Utility to convert fgsea/ultragsea style results to 'gseaResult' object compatible with clusterProfiler and enrichplot functions. Using this function you can use all plotting functions from enrichplot. — makeGseaResult","text":"Utility convert fgsea/ultragsea style results 'gseaResult' object compatible clusterProfiler enrichplot functions. Using function can use plotting functions enrichplot.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/makeGseaResult.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Utility to convert fgsea/ultragsea style results to 'gseaResult' object compatible with clusterProfiler and enrichplot functions. Using this function you can use all plotting functions from enrichplot. — makeGseaResult","text":"","code":"makeGseaResult(res, geneList, geneSets)"},{"path":"https://bigomics.github.io/ultragsea/reference/mat2gmt.html","id":null,"dir":"Reference","previous_headings":"","what":"Convert Binary Matrix to GMT — mat2gmt","title":"Convert Binary Matrix to GMT — mat2gmt","text":"Convert binary matrix GMT (Gene Matrix Transposed) list. binary matrix indicates presence absence genes gene set. Rows represent genes columns represent gene sets.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/mat2gmt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Convert Binary Matrix to GMT — mat2gmt","text":"","code":"mat2gmt(mat)"},{"path":"https://bigomics.github.io/ultragsea/reference/mat2gmt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Convert Binary Matrix to GMT — mat2gmt","text":"mat Matrix non-zero entries representing genes gene set. Rows represent genes columns represent gene sets.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/mat2gmt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Convert Binary Matrix to GMT — mat2gmt","text":"list vector representing gene set. list element correspond gene set vector genes","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/mat2gmt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Convert Binary Matrix to GMT — mat2gmt","text":"","code":"# Create example binary matrix mat <- matrix(0, nrow = 6, ncol = 3) rownames(mat) <- paste0(\"GENE\", 1:6) colnames(mat) <- paste0(\"Pathway\", 1:3) mat[1:3, 1] <- 1  # Pathway1: GENE1, GENE2, GENE3 mat[c(2,4,5), 2] <- 1  # Pathway2: GENE2, GENE4, GENE5 mat[c(1,5,6), 3] <- 1  # Pathway3: GENE1, GENE5, GENE6  # Convert to GMT list gmt <- mat2gmt(mat) print(gmt) #> $Pathway1 #> [1] \"GENE1\" \"GENE2\" \"GENE3\" #>  #> $Pathway2 #> [1] \"GENE2\" \"GENE4\" \"GENE5\" #>  #> $Pathway3 #> [1] \"GENE1\" \"GENE5\" \"GENE6\" #>"},{"path":"https://bigomics.github.io/ultragsea/reference/read.gmt.html","id":null,"dir":"Reference","previous_headings":"","what":"Read GMT File — read.gmt","title":"Read GMT File — read.gmt","text":"Read data GMT file (Gene Matrix Transposed). GMT format commonly used store gene sets gene annotations.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/read.gmt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Read GMT File — read.gmt","text":"","code":"read.gmt(gmt.file, dir = NULL, add.source = FALSE, nrows = -1)"},{"path":"https://bigomics.github.io/ultragsea/reference/read.gmt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Read GMT File — read.gmt","text":"gmt.file Path GMT file. dir (Optional) directory GMT file located. add.source (optional) Include source information gene sets' names. nrows (optional) Number rows read GMT file.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/read.gmt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Read GMT File — read.gmt","text":"list gene sets: gene set represented character vector gene names.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/read.gmt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Read GMT File — read.gmt","text":"","code":"# \\donttest{ # Read GMT file (requires file to exist) gmt_file <- system.file(\"extdata\", \"hallmarks.gmt\", package = \"plaid\") if (file.exists(gmt_file)) {   gmt <- read.gmt(gmt_file)   print(names(gmt))   print(head(gmt[[1]]))      # Read with source information   gmt_with_source <- read.gmt(gmt_file, add.source = TRUE)   print(head(names(gmt_with_source))) } # }"},{"path":"https://bigomics.github.io/ultragsea/reference/ultragsea.html","id":null,"dir":"Reference","previous_headings":"","what":"Ultra-fast GSEA using z-score or geneset correlation. Results of these methods highly correlate with GSEA/fGSEA but are much faster. — ultragsea","title":"Ultra-fast GSEA using z-score or geneset correlation. Results of these methods highly correlate with GSEA/fGSEA but are much faster. — ultragsea","text":"Ultra-fast GSEA using z-score geneset correlation. Results methods highly correlate GSEA/fGSEA much faster.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/ultragsea.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Ultra-fast GSEA using z-score or geneset correlation. Results of these methods highly correlate with GSEA/fGSEA but are much faster. — ultragsea","text":"","code":"ultragsea(   G,   fc,   alpha = 0.5,   minLE = 1,   corshrink = 3,   minsize = 1L,   maxsize = 9999L,   center = TRUE,   method = c(\"cor\", \"ztest\", \"ttest\", \"goat\", \"camera\")[1],   format = c(\"simple\", \"as.gsea\")[1] )"},{"path":"https://bigomics.github.io/ultragsea/reference/write.gmt.html","id":null,"dir":"Reference","previous_headings":"","what":"Write GMT File — write.gmt","title":"Write GMT File — write.gmt","text":"Write gene sets GMT file (Gene Matrix Transposed). GMT format commonly used store gene sets gene annotations.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/write.gmt.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Write GMT File — write.gmt","text":"","code":"write.gmt(gmt, file, source = NA)"},{"path":"https://bigomics.github.io/ultragsea/reference/write.gmt.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Write GMT File — write.gmt","text":"gmt list gene sets GMT format: gene set represented vector gene names. file file path write GMT file. source character vector specifying source gene set. provided, names gene sets used source.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/write.gmt.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Write GMT File — write.gmt","text":"return anything.","code":""},{"path":"https://bigomics.github.io/ultragsea/reference/write.gmt.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Write GMT File — write.gmt","text":"","code":"# Create example GMT data gmt <- list(   \"Pathway1\" = c(\"GENE1\", \"GENE2\", \"GENE3\"),   \"Pathway2\" = c(\"GENE2\", \"GENE4\", \"GENE5\"),   \"Pathway3\" = c(\"GENE1\", \"GENE5\", \"GENE6\") )  # \\donttest{ # Write to GMT file (creates file in temp directory) temp_file <- tempfile(fileext = \".gmt\") write.gmt(gmt, temp_file)  # Write with custom source information temp_file2 <- tempfile(fileext = \".gmt\") write.gmt(gmt, temp_file2, source = c(\"DB1\", \"DB2\", \"DB3\"))  # Clean up unlink(c(temp_file, temp_file2)) # }"}]
