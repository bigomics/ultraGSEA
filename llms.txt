# UltraGSEA: Ultrafast preranked gene set enrichment analysis (WIP)

[![codecov](https://codecov.io/github/bigomics/ultragsea/graph/badge.svg?token=66J6W41C0G)](https://codecov.io/github/bigomics/ultragsea)

(Warning: ***work in progress***! do not use for production purposes)

[ultragsea](https://bigomics.github.io/ultragsea) is an ultrafast method
to compute gene set enrichment on a preranked list of genes not unlike
fGSEA. ultragsea can be used as replacement of fGSEA. Although ultragsea
uses a different statistical test (namely z-test or correlation), its
scores are highly correlated and its p-values are closely similar to
those from GSEAâ€™s weighted Kolmogorov-Smirnov test. ultragsea computes
its scores using fast sparse computation and parametric p-values and
typically is 100x faster than fGSEA.

## Installation

You can install ultragsea from from GitHub:

``` r
remotes::install_github("bigomics/ultragsea")
```

## Usage

For detailed usage examples and tutorials, please see our vignettes:

- [Getting Started with
  ultragsea](https://bigomics.github.io/ultragsea/articles/ultragsea.html)
- [Comparing ultragsea with other
  methods](https://bigomics.github.io/ultragsea/articles/compare-methods.html)
- [Benchmarking
  results](https://bigomics.github.io/ultragsea/articles/benchmark.html)

ultragsea is the main gene set scoring algorithm in OmicsPlayground, our
Bioinformatics platform at BigOmics Analytics. In OmicsPlayground, you
can perform ultragsea without coding needs.

## Example

`{r} library(ultragsea) gs <- msigdbr::msigdbr(collection = "H") gmt <- tapply(gs$gene_symbol,gs$gs_name,list) G <- gmt2mat(gmt) fc <- rnorm(nrow(G)) names(fc) <- rownames(G) res <- ultragsea(fc, G, format='as.gsea', method='ztest') head(res)`

## References

For more technical details please refer to our papers. Please cite us
when you use ultragsea as part of your research.

- ultragsea: Ultrafast preranked gene set enrichment scoring.
- Akhmedov M., et al., Omics Playground: a comprehensive self-service
  platform for visualization, analytics and exploration of Big Omics
  Data, NAR Genomics and Bioinformatics, 2020,
  [lqz019](https://doi.org/10.1093/nargab/lqz019).

## Support

For support feel free to reach our Bioinformatics Data Science Team at
BigOmics Analytics: <help@bigomics.ch>

If you like ultragsea, please recommend us to your friends, buy us
[coffee](https://buymeacoffee.com/bigomics) and brag about ultragsea on
your social media.

# Package index

## All functions

- [`cor_pvalue()`](https://bigomics.github.io/ultragsea/reference/cor_pvalue.md)
  : Calculate p-value from correlation rho
- [`cor_sparse_matrix()`](https://bigomics.github.io/ultragsea/reference/cor_sparse_matrix.md)
  : Calculate sparse correlation matrix handling missing values
- [`corpora.fisher.pval()`](https://bigomics.github.io/ultragsea/reference/corpora.fisher.pval.md)
  : Superfast version of Fisher Exact Test from 'corpora' R package.
- [`corporaFET()`](https://bigomics.github.io/ultragsea/reference/corporaFET.md)
  : Wrapper around fast version of Fisher Exact Test from 'corpora' R
  package.
- [`fastFET()`](https://bigomics.github.io/ultragsea/reference/fastFET.md)
  : Fast version of Fisher Exact Test from 'genesetr' R package.
- [`fgsea()`](https://bigomics.github.io/ultragsea/reference/fgsea.md) :
  Fast replacement of fgsea with p/q values computed with ultragsea.cor
- [`gmt2mat()`](https://bigomics.github.io/ultragsea/reference/gmt2mat.md)
  : Convert GMT to Binary Matrix
- [`goat()`](https://bigomics.github.io/ultragsea/reference/goat.md) :
  Wrapper around GOAT
- [`gset.cor()`](https://bigomics.github.io/ultragsea/reference/gset.cor.md)
  : Calculate gene set correlation
- [`gset.fastFET()`](https://bigomics.github.io/ultragsea/reference/gset.fastFET.md)
  : Calculate fast Fisher exact test.
- [`gset.ztest()`](https://bigomics.github.io/ultragsea/reference/gset.ztest.md)
  : Fast one sample z-test for matrix object F (e.g. foldchanges) and
  grouping matrix G (e.g. gene sets).
- [`makeGseaResult()`](https://bigomics.github.io/ultragsea/reference/makeGseaResult.md)
  : Utility to convert fgsea/ultragsea style results to 'gseaResult'
  object compatible with clusterProfiler and enrichplot functions. Using
  this function you can use all plotting functions from enrichplot.
- [`mat2gmt()`](https://bigomics.github.io/ultragsea/reference/mat2gmt.md)
  : Convert Binary Matrix to GMT
- [`read.gmt()`](https://bigomics.github.io/ultragsea/reference/read.gmt.md)
  : Read GMT File
- [`ultragsea()`](https://bigomics.github.io/ultragsea/reference/ultragsea.md)
  : Ultra-fast GSEA using z-score or geneset correlation. Results of
  these methods highly correlate with GSEA/fGSEA but are much faster.
- [`write.gmt()`](https://bigomics.github.io/ultragsea/reference/write.gmt.md)
  : Write GMT File

# Articles

### All vignettes

- [Benchmarking
  Results](https://bigomics.github.io/ultragsea/articles/benchmark.md):
- [Comparing with other
  methods](https://bigomics.github.io/ultragsea/articles/compare-methods.md):
- [Getting Started with
  ultragsea](https://bigomics.github.io/ultragsea/articles/ultragsea.md):
