---
title: "Getting Started with ultragsea"
author: "BigOmics Analytics"
package: ultragsea
output:
    BiocStyle::html_document
vignette: >
  %\VignetteIndexEntry{Getting Started with ultragsea}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.align = "center"
)
```

# Introduction

ultragsea is a novel, ultrafast and memory optimized gene set
enrichment scoring algorithm not unlike fGSEA. ultragsea demonstrates
highly correlated gene set scores and p-values and typically is 100
times faster than fGSEA.

# Example

## Preparing gensets

For this vignette, our package includes a small subset of the the
pmbc3k single-cell dataset of just 50 cells. Please install the Seurat
and SeuratData packages if you want to run this vignette against the
full dataset.

```{r}
library("ultragsea")
library("msigdbr")
gs <- msigdbr::msigdbr(collection = "H")
gmt <- tapply(gs$gene_symbol,gs$gs_name,list)
length(gmt)
```

## Performing the statistical test

```{r}
G <- gmt2mat(gmt)
fc <- rnorm(nrow(G))
names(fc) <- rownames(G)
res <- ultragsea(fc, G, format='as.gsea', method='ztest')
head(res)
```

## Plotting

```{r}
#library(fgsea)
#fgsea::plotEnrichment(gmt[[1]], fc,ticksSize = 0.2)
#enrichplot::gseaplot2(edo2, geneSetID = 1:3)
```


# Benchmarking

```{r}


```


# Session info

```{r}
sessionInfo()
```
